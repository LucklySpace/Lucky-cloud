spring:
  application:
    name: im-database
  profiles:
    active: ${APP_PROFILES_ACTIVE:@app.profiles.active@}

  cloud:
    sentinel:
      eager: true
      transport:
        dashboard: ${SENTINEL_DASHBOARD_URL:@sentinel.dashboard.url@}
    discovery:
      client:
        simple:
          local:
            instance-id: ${spring.application.name}-${random.value}
    nacos:
      discovery:
        server-addr: ${NACOS_DISCOVERY_SERVER_ADDR:@nacos.config.server-addr@}
        username: ${NACOS_DISCOVERY_USERNAME:@nacos.discovery.username@}
        password: ${NACOS_DISCOVERY_PASSWORD:@nacos.discovery.password@}
        namespace: ${NACOS_DISCOVERY_NAMESPACE:@nacos.discovery.namespace@}
        group: ${NACOS_DISCOVERY_GROUP:@nacos.discovery.group@}

      config:
        server-addr: ${NACOS_CONFIG_SERVER_ADDR:@nacos.config.server-addr@}
        namespace: ${NACOS_CONFIG_NAMESPACE:@nacos.config.namespace@}
        group: ${NACOS_CONFIG_GROUP:@nacos.config.group@}
        name: ${spring.application.name}-@app.profiles.active@
        file-extension: yml

dubbo:
  application:
    name: ${spring.application.name}
    serialize-check-status: WARN
  protocol:
    name: dubbo # 通信协议
    port: -1 # dubbo协议端口
  consumer:
    check: false    # 让 consumer 不在启动时校验 provider 是否存在
    timeout: 5000
  provider:
    delay: -1  # 延迟暴露服务
  registry:
    address: nacos://${NACOS_DISCOVERY_SERVER_ADDR:@nacos.config.server-addr@}
    register-mode: instance # 注册模式

server:
  http2:
    enabled: true
  port: ${SERVER_PORT:@im-database.server.port@}


# seata 配置
seata:
  enabled: true
  # 数据源代理模式
  data-source-proxy-mode: AT
  application-id: ${spring.application.name}
  config:
    type: nacos
    nacos:
      server-addr: ${NACOS_CONFIG_SERVER_ADDR:@nacos.config.server-addr@}
      namespace: ${SEATA_CONFIG_NAMESPACE:@seata.config.namespace@}
      group: ${SEATA_CONFIG_GROUP:@seata.config.group@}
      username: ${NACOS_DISCOVERY_USERNAME:@nacos.discovery.username@}
      password: ${NACOS_DISCOVERY_PASSWORD:@nacos.discovery.password@}
      data-id: ${SEATA_CONFIG_DATA_ID:@seata.config.data.id@}
  # 事务组名称
  tx-service-group: default_tx_group
  # 注册seata
  registry:
    type: nacos
    nacos:
      server-addr: ${NACOS_DISCOVERY_SERVER_ADDR:@nacos.discovery.server-addr@}
      application: seata-server
      group: ${SEATA_CONFIG_GROUP:@seata.config.group@}
      namespace: ${SEATA_CONFIG_NAMESPACE:@seata.config.namespace@}
      username: ${NACOS_DISCOVERY_USERNAME:@nacos.discovery.username@}
      password: ${NACOS_DISCOVERY_PASSWORD:@nacos.discovery.password@}
  client:
    rm:
      # 是否上报成功状态
      report-success-enable: true